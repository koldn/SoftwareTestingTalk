<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>DistSearch</title>

    <meta name="description" content="SMP Distributed search experience">
    <meta name="author" content="Dmitriy Kolmogortsev">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css" id="theme">

    <link rel="stylesheet" href="css/hljs/idea.css" id="highlight-theme">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

    <style>
        .reveal .slide-number {
            font-size: 22pt;
            color: black;
        }
        
        .reveal pre {
            background: none;
            border: none;
            box-shadow: none;
        }
        
        .reveal pre code {
            color: black;
            background: none;
            box-shadow: none;
            max-height: none;
        }
        /* .reveal section img {
            border: none;
            box-shadow: none;
        }*/
        
        .reveal pre code {
            overflow: hidden;
        }
        
        .reveal .footer {
            font-size: 22pt;
            position: absolute;
            left: 35%;
            bottom: 0.5em;
        }
        
        #corp-name {
            color: orangered;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }
        
        .stroke {
            text-decoration: line-through;
        }
        
        .red-text {
            color: red;
        }
    </style>
</head>

<body>

    <div class="reveal">
        <div class="footer">
            <span id="corp-name"><b>NAUMEN</b></span>
            <span id="speaker-name">Колмогорцев Дмитрий</span>
        </div>
        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section>
                <h4>Тестирование програмного обеспечения</h4>
                <h5>Как это?</h5>
                <p>
                    <small>
                        Колмогорцев Дмитрий / <a href="mailto:dkolmogortsev@naumen.ru">dkolmogortsev@naumen.ru</a>
                        <br/>
                        <br/>
                    </small>
                </p>
            </section>
            <section>
                <h3>План:</h3>
                <ol>
                    <li>Собственно, зачем тестировать?</li>
                    <li>Виды тестирования</li>
                    <li>Инструменты</li>
                    <li>TDD</li>
                    <li>BDD</li>
                    <li>UI-Testing</li>
                    <li>Stress testing</li>
                </ol>
            </section>
            <section>
                <h3>Зачем тестировать?</h3>
                <p id="checkNoBugs">Проверить, что багов нет!</p>
                <p class="fragment" id="aVotInet">А вот и нет!</p>
            </section>
            <section>
                <h3>Цели тестирования:</h3>
                <ul>
                    <li class="fragment"> Определить, что продукт соотвествует заявленным требованиям</li>
                    <li class="fragment"> Адекватно работает при любом наборе входных данных</li>
                    <li class="fragment"> Выдает результат за адекватное время</li>
                </ul>
            </section>
            <section>
                <h4>Ручное тестирование</h4>
                <ul>
                    <li>Довольно затратно</li>
                    <li>Тестировать регрессию еще более затратно</li>
                    <li>Порой имеет место человеческий фактор</li>
                </ul>
            </section>
            <section>
                <h4>Автоматизированное тестирование</h4>
                <ul>
                    <li>Тоже не бесплатно</li>
                    <li>Тестировать регрессию почти ничего не стоит</li>
                    <li>Суждение робота неизменно</li>
                    <li>Человеческий фактор, все таки тоже имеет место быть</li>
                </ul>
            </section>
            <section>
                <h4>AT</h4>
                <img src="img/test_pyramid.png"/>
            </section>
            <section>
                <h4>Модульное тестирование<br>(Unit testing)</h4>
                <img src="img/unit_test.png">
            </section>
            <section>
                <h4>Sample</h4>
                <pre>
                    <code class="java" data-trim>
package org.testingtalk.account;
                            
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.atomic.AtomicInteger;
                            
public class AccountInfoService
{
    private final AtomicInteger idSequence = new AtomicInteger();
                            
    private final ConcurrentHashMap&ltLong, AccountInfo&gt accountsData = new ConcurrentHashMap&ltLong, AccountInfo&gt();
                            
    public AccountInfo createNewAccountInfo(){
        AccountInfo newInfo = new AccountInfo(idSequence.getAndIncrement());
        accountsData.put(newInfo.getAccountId(), newInfo);
        return newInfo;
    }
    ...
}
                    </code>
                </pre>
            </section>
            <section>
                <h4>Как бы протестить?</h4>
                <ol>
                    <li class="fragment">Подготовить данные</li>
                    <li class="fragment">Что-то сделать с данными</li>
                    <li class="fragment">Проверить результат дейсвтий</li>
                    <li class="fragment">Убрать за собой, если требуется</li>
                </ol>
            </section>
            <section>
                <h4>В первом приближении</h4>
                <pre>
                    <code class="java" data-trim>
                        public static void main(String[] args)
                        {   
                            //Подготовка
                            AccountInfoService service = new AccountInfoService();
                            //Действия
                            AccountInfo info = service.createNewAccountInfo();
                            //Проверка
                            assert 0 == info.getBalance();
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h4>А можно не через main?</h4>
                <div class="fragment">
                    <p>Можно - JUnit</p>
                    <pre>
                        <code class="java" data-trim>
                            import static org.junit.Assert.*;
                            import org.junit.Test;

                            public class AccountInfoTest {

                                @Test
                                public void testNewInfoBalanceIsZero(){
                                    //Подготовка
                                    AccountInfoService service = new AccountInfoService();
                                    //Действия
                                    AccountInfo newInfo = service.createNewAccountInfo();
                                    //Проверка
                                    String message = "Balance is non zero"
                                    assertEquals(message,0, newInfo.getBalance());
                                }
                            }
                        </code>
                    </pre>
                </div>
            </section>
            <section>
                <h4>JUnit аннотации</h4>
                <pre>
                    <code class="java" data-trim>
                        public class BaseTest{
                            @BeforeClass //Действия перед запуском класса
                            public static void setupClass() {}

                            @Before //Действия перед зауском теста
                            public void setup() {}

                            @After //Действия после завершения теста
                            public void tearDown() {}

                            @AfterClass //Действия после завершения тестового класса
                            public void tearDownClass() {}
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h4>Можно и так</h4>
                <pre>
                    <code class="java" data-trim>
                        public class ConreteTest extends BaseTest{
                            //Действия перед запуском тестов
                            //Для данного класса, в дополнение к BaseTest#setup()
                            @Before 
                            public void setupConcrete() {}
                            ...
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h3>@Test</h3>
                <pre>
                    <code class="java" data-trim>
                            @Retention(RetentionPolicy.RUNTIME)
                            @Target({ElementType.METHOD})
                            public @interface Test {
                                //Какой Exception мы ожидаем при тесте
                                Class&lt? extends Throwable&gt expected() \
                                default Test.None.class; 
                            
                                long timeout() default 0L; //Таймаут выполнения теста
                            
                                public static class None extends Throwable {
                                    private static final long serialVersionUID = 1L;
                            
                                    private None() {
                                    }
                                }
                            }
                    </code>
                </pre>
            </section>
            <section>
                <h4>Что может быть</h4>
                <pre>
                    <code class="java" data-trim>
                        public class AccountInfoServiceTest {
                            private AccountInfoService service;
                            
                            @Before
                            public void setup(){
                                this.service = new AccountInfoService();
                            }

                            @Test(expected = IllegalArgumentException.class)
                            public void testErrorWhenLoadNull(){
                                this.service.getInfo(null);
                            }

                            @Test(timeout = 1000)
                            public void testLoadWithinASecond(){
                                this.service.get(1);
                            }
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h4>Интеграционное тестирование</h4>
                <img src="img/integration_test.png">
            </section>
            <section>
                <h4>Как быть с зависимостями?</h4>
                <ul>
                    <li class="fragment">Удовлетворять зависимости реальными объектами</li>
                    <li class="fragment">Использовать моки( Mocks )</li>
                    <li class="fragment">Использовать stub</li>
                </ul>
            </section>
            <section>
                ${stub vs mocks}
            </section>
            <section>
                ${test with mocks sample}
            </section>
            <section>
                            ${test with mocks sample}
            </section>
            <section>
                <h4>Функциональное тестирование ( UI )</h4>
            </section>
            <section>
                    <h2>Selenium</h2>
                    Инcтрумент для автоматизированного тестирования WEB-приложений<br>
                    <ul>
                        <li>Selenium WebDriver</li>
                        <li>Selenium Grid</li>
                    </ul>
                </section>
                <section>
                    <h2>Selenium Webdriver</h2>
                    <ul>
                        <li>Реализация на многих языках
                        <li>Из коробки поддерживает управление Firefox
                        <li>Можно научить управлять даже IE</li>
                    </ul>
                </section>
                <section>
                    <h2>Samples</h2>
                    <pre style="width:auto;"><code data-trim class="java">
// Создаем новый webdriver с указанием на банарник firefox
WebDriver wd = new FirefoxDriver(new FirefoxBinary(
new File("D:\\ff\\firefox.exe")), new FirefoxProfile());  
</code></pre>
                </section>

<section>
                    <h2>Samples</h2>
                    <pre style="width:auto;"><code data-trim class="java">
// Открываем гугл
wd.get("http://www.google.com");
</code></pre>
                </section>

                <section>
                    <h2>Samples</h2>
                    <pre style="width:auto;"><code data-trim class="java">
final String searchString = "selenium";

// Находим поисковую строку и ищем "selenium"
WebElement searchBox = wd.findElement(By.name("q"));
searchBox.sendKeys(searchString);
searchBox.submit();
</code></pre>
                </section>

                <section>
                    <h2>Samples</h2>
                    <pre style="width:auto;"><code data-trim class="java">
// т.к. google асинхронный - ждем поисковой выдачи
(new WebDriverWait(wd, 10)).until(new ExpectedCondition&lt;Boolean&gt;() {
    public Boolean apply(WebDriver d) {
         return d.getTitle().toLowerCase().startsWith(searchString);
    }
});
</code></pre>
                </section>


                <section>
                    <h2>Samples</h2>
                    <pre style="width:auto;"><code data-trim class="java">
// закрываем webdriver
wd.quit();
                </code></pre>
                </section>

                <section>
                    <h2>All together</h2>
                    <pre style="width:auto;"><code data-trim class="java" style="font-size:80%;">
public class SeleniumSample {
    public static void main(String[] args) throws InterruptedException {
        // Создаем новый webdriver с указанием на банарник firefox
        WebDriver wd = new FirefoxDriver(new FirefoxBinary(new File(
                "D:\\ff\\firefox.exe")), new FirefoxProfile());
        // Открываем гугл
        wd.get("http://www.google.com");
        final String searchString = "selenium";
        // Находим поисковую строку и ищем "selenium"
        WebElement searchBox = wd.findElement(By.name("q"));
        searchBox.sendKeys(searchString);
        searchBox.submit();
        // т.к. google асинхронный - ждем поисковой выдачи
        (new WebDriverWait(wd, 10)).until(new ExpectedCondition&lt;Boolean&gt;() {
            public Boolean apply(WebDriver d) {
                return d.getTitle().toLowerCase().startsWith(searchString);
            }
        });
        // закрываем webdriver
        wd.quit();
    }
}
</code></pre>
                </section>
                <section>
                    <h4>Когда тесты запускать?</h4>
                    <ul>
                        <li>Всегда</li>
                        <li>Написал код - запусти тесты</li>
                        <li>При сборке проекта</li>
                        <li>В CI</li>
                    </ul>
                </section>
                <section>
                    ${TDD}
                </section>
                <section>
                    ${BDD}
                </section>
                <section>
                    JUnit VS Spock
                </section>
                <section>
                    ${TDD}
                </section>

                <section>
                        <h2>Нагрузочное тестирование</h2>
                        <img src="img/load.jpg" height="500px" />
                    </section>
                    <section>
                        <h2>Проблема</h2>
                        <ul>
                            <li>Написана новая версия продукта - 4.0 (прошлая 3.8)
                            <li>Старой пользуется много крупных клиентов(большое кол-во пользователей одновременно)
                            <li>Новый продукт, конечно, прекрасен, но мы не знаем насколько хорошо он работает
                            <li>Нужно сэмулировать работу пользователей
                        </ul>
                    </section>
                    <section>
                        <h2>Тестирование производительности</h2>
                        <div>Проверить как быстро может работать система или её компоненты</div>
                        <div>Что можно проверить:</div>
                        <ul>
                            <li>Время отклика
                            <li>Время отображения
                            <li>Пропускную способность
                        </ul>
                    </section>
                    <section style="width: 100%">
                        <h2>Время отклика</h2>
                        <img src="img/resp.png" style="height: 500px">
                    </section>
                    <section>
                        <h2>Время отображения</h2>
                        <img src="img/render.png" style="height: 500px; max-height:150%">
                    </section>
                    <section>
                        <h2>Пропускная способность</h2>
                        <img src="img/bottleneck.jpg" style="height: 500px">
                    </section>
                    <section>
                        <h2>Виды тестирования производительности:</h2>
                        <ul>
                            <li>Нагрузочное(load)
                            <li>Стресс (stress)</li>
                        </ul>
                    </section>
    
                    <section>
                        <h2>Нагрузочное тестирование</h2>
                        Цель: проверить показатели работы приложения при ожидаемой нагрузке
                    </section>
    
    
                    <section>
                        <h2>Стресс тестирование</h2>
                        Цель: проверить показатели работы приложения при диспропорциональной нагрузке
                    </section>
                    <section>
                        <h2>Stress in a nutshell</h2>
                        <img src="img/stress.png">
                    </section>
                    <section>
                        <h2>Процесс проведения</h2>
                        <ol>
                            <li>Определяем требуемые показатели
                            <li>Определяем сценарий нагрузочного тестирования
                            <li>Проводим тестирование*
                            <li>Собираем результат
                            <li>??????
                            <li>PROFIT, а может и нет
                        </ol>
                        <p style="font-size: 20pt;">*Проводить тестирование всегда стоит на одном и том же сервере</p>
                    </section>
    
                    <section>
                        <h2>JMeter</h2>
                        <p>Умеет тестировать:</p>
                        <ul>
                            <li>Web
                            <li>JDBC
                            <li>и другое
                        </ul>
                    </section>
                        
                     <section>
                        <h2>Получаем сценарий</h2>
                        <div>Два пути:</div>
                        <ol>
                            <li>Написать запросы руками
                            <li style="color: green;" >Записать сценарий из браузера
                        </ol>
                    </section>
    
                    <section>
                        <h2>Запись сценария</h2>
                        <img src="img/proxy.png" height="400px">
                    </section>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
        // Full list of configuration options available at:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: false,
            progress: true,
            history: true,
            center: true,
            slideNumber: true,

            transition: 'slide', // none/fade/slide/convex/concave/zoom

            // Optional reveal.js plugins
            dependencies: [{
                src: 'lib/js/classList.js',
                condition: function() {
                    return !document.body.classList;
                }
            }, {
                src: 'plugin/markdown/marked.js',
                condition: function() {
                    return !!document.querySelector('[data-markdown]');
                }
            }, {
                src: 'plugin/markdown/markdown.js',
                condition: function() {
                    return !!document.querySelector('[data-markdown]');
                }
            }, {
                src: 'plugin/highlight/highlight.js',
                async: true,
                condition: function() {
                    return !!document.querySelector('pre code');
                },
                callback: function() {
                    hljs.initHighlightingOnLoad();
                }
            }, {
                src: 'plugin/zoom-js/zoom.js',
                async: true
            }, {
                src: 'plugin/notes/notes.js',
                async: true
            }]
        });

        Reveal.addEventListener('fragmentshown', function(event) {
            if (event.fragment.id == 'aVotInet') {
                document.getElementById('checkNoBugs').classList.add("stroke");
            }
        });

        Reveal.addEventListener('fragmenthidden', function(event) {
            if (event.fragment.id == 'aVotInet') {
                document.getElementById('checkNoBugs').classList.remove("stroke");
            }
        });
    </script>

</body>

</html>